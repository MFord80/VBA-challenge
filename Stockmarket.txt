Sub StockMarket()' Summary Table Headings    Cells(1, 9).Value = "Ticker"    Cells(1, 10).Value = "Yearly Change"    Cells(1, 11).Value = "Percent Change"    Cells(1, 12).Value = "Total Stock Volume"' Variables    Dim Ticker As String    Dim Yearly_Change As Double    Dim Percent_Change As Double    Dim Stock_Volume As Double    Stock_Volume = 0        Dim Year_Open_Price As Double    Dim Year_Close_Price As Double    Year_Open_Price = Cells(2, 3).Value        Dim Summary_Table_Row As Integer    Summary_Table_Row = 2    ' Table length    Dim Lastrow As Long    Lastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row  ' Loop through all rows of the tableFor i = 2 To Lastrow    ' Add to the Stock Volume    Stock_Volume = Stock_Volume + Cells(i, 7).Value' Check if row represents a new Ticker    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then' Set the Ticker        Ticker = Cells(i, 1).Value        'Set the Year_Close_Price        Year_Close_Price = Cells(i, 6).Value' Print the Ticker in the Summary Table        Range("I" & Summary_Table_Row).Value = Ticker      ' Set the Yearly Change        Yearly_Change = Year_Close_Price - Year_Open_Price' Print the Yearly Change in the Summary Table        Range("J" & Summary_Table_Row).Value = Yearly_Change' Set the Percentage Change        Percentage_Change = Yearly_Change / Year_Open_Price' Print the Percentage Change in the Summary Table        Range("K" & Summary_Table_Row).Value = Percentage_Change' Print the Total Stock Volume in the Summary Table        Range("L" & Summary_Table_Row).Value = Stock_Volume        ' Reset the Stock Volume        Stock_Volume = 0'Set the Year_Open_Price        Year_Open_Price = Cells(i + 1, 3).Value        ' Add one to the summary table row        Summary_Table_Row = Summary_Table_Row + 1        Else    End IfNext i' Summary Table lengthDim Summary_Table_Lastrow As IntegerSummary_Table_Lastrow = ActiveSheet.Cells(Rows.Count, 9).End(xlUp).Row' Loop through all rows of the Summary TableFor j = 2 To Summary_Table_Lastrow' Yearly Change conditional formatting    If Cells(j, 10).Value > 0 Then        Cells(j, 10).Interior.ColorIndex = 4    ElseIf Cells(j, 10).Value < 0 Then        Cells(j, 10).Interior.ColorIndex = 3    Else        Cells(j, 10).Interior.ColorIndex = 2    End If' Percentage Change number formatting    Cells(j, 11).Value = Format(Cells(j, 11).Value, "Percent")      Next j' Column widths    Range("J1").ColumnWidth = 10.5    Range("K1").ColumnWidth = 12    Range("L1").ColumnWidth = 15' BONUS' Bonus Table Headings    Cells(1, 16).Value = "Ticker"    Cells(1, 17).Value = "Value"    Cells(2, 15).Value = "Greatest % Increase"    Cells(3, 15).Value = "Greatest % Decrease"    Cells(4, 15).Value = "Greatest Total Volume"' VariablesDim Max_Increase As Double        'Greatest % IncreaseDim Max_Increase_Ticker As StringDim Max_Decrease As Double       'Greatest % DecreaseDim Max_Decrease_Ticker As StringDim Max_Volume As Double         'Greatest Total VolumeDim Max_Volume_Ticker As StringMax_Increase = 0Max_Decrease = 0Max_Volume = 0' Loop through all the rows of the Summary TableFor k = 2 To Summary_Table_Lastrow    ' Is Change the highest...    If Cells(k, 11).Value > Max_Increase Then        Max_Increase = Cells(k, 11).Value        Max_Increase_Ticker = Cells(k, 9).Value    End If' Is Change the lowest...    If Cells(k, 11).Value < Max_Decrease Then        Max_Decrease = Cells(k, 11).Value        Max_Decrease_Ticker = Cells(k, 9).Value    End If' Is Total Stock Volume the highest...    If Cells(k, 12).Value > Max_Volume Then        Max_Volume = Cells(k, 12).Value        Max_Volume_Ticker = Cells(k, 9).Value        End IfNext k' Print the values    Cells(2, 16).Value = Max_Increase_Ticker    Cells(2, 17).Value = Max_Increase    Cells(3, 16).Value = Max_Decrease_Ticker    Cells(3, 17).Value = Max_Decrease    Cells(4, 16).Value = Max_Volume_Ticker    Cells(4, 17).Value = Max_Volume' Percentage Change number formatting    Cells(2, 17).Value = Format(Cells(2, 17).Value, "Percent")    Cells(3, 17).Value = Format(Cells(3, 17).Value, "Percent")  ' Column widths    Range("O1").ColumnWidth = 18    Range("Q1").ColumnWidth = 12End Sub' lastrow formula derived from here:' https://stackoverflow.com/questions/17327037/how-to-select-a-range-of-the-second-row-to-the-last-row